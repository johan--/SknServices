<?xml version="1.0"?>
<accessRegistry>
<!--
   config/access_registry.xml

   Along with class AccessRegistry and module AccessControl, this file describes those
   application resources that should be both secured and un-secured. This file is pre-processed
   by the class AccessRegistryUtility to enable the overall Authorization capability: which converts
   it into a Hash object.

   There are two general sets of entries or URIs.
        Page Entries
            Composed of URI: <controller_name>/<action_action>, example: "pages/home"
        Resource Entries
            Composed of URI: <any.string> you choose to represent a general permission.
            Typically you would makeup a URI and use that uri exclusively for an 'Add' button,
            or other click-able resource in your application.

   Page Entries are automatically validated by a security filter/callback plugged into the app's base controller,
   as a part of the AuthenticationControllerHelper::login_required() functionality.  If the user does not have
   a matching role for the current controller/action then they are redirected to the home page and given
   a 'not authorized' warning; otherwise they pass through to the desired page.

   Resource Entries are coded/implemented by you.  You decide on an URI syntax to composed a uri and then you
   use that name to verify access to a particular clickable before making it visible or allowing the user
   to take that action.  The User model includes a method called 'has_access?(uri, options)' which returns
   true if the user's permissions/roles are included in the URI's access list; otherwise false is returned. An
   example syntax might be "<Context>.<PageName>.<ActionName>" or "<Context>.<ProcessName>.<ActionName>"; where
   an example uri from the latter would be "User.PasswordReset.RequestReset", or "Client.FileUpload.Upload".
   Basically, your trying to authorize that a user "Can do a thing or action, and must give that action a uri!"

   Authorization is accomplished by first declaring URIs for all Pages, then all Resources that need to be secured.
   URI's are plain text strings which contain the label of the thing to be secured.  On the surrounding <resource>
   statement is a 'secured' attribute which indicates if this resource record is secure or not.  If its not, the
   record is considered documentation and will always return true to the #has_access?() api.

   Should a #has_access? request be made with a uri not recorded in the access registry, the default return is TRUE.
   Effectively granting access to any undocumented resource.

   Second, each entry is evaluated using the semantics of CRUD.  CREATE, READ, UPDATE, DELETE permissions
   each contain a list of authorized roles which a user MUST match one in order to be considered as having
   permission.  The user object is expected to have an array list of authorization 'roles' which was granted
   them by some administrator.  Permission entries are considered and created at application design time
   and represent the application's clickable capabilities, or pages and task links.

   Each authorized role in a permission statement may have one additional attribute named options.  An options
   attribute is composed of a string with one or more comma separated values; ex. options="OWNER,SCHEDULER,MANAGER".
   These entries if present must be matched by user's provided option value and the correct role, for the users
   authorization request to be granted.  Having the correct authorized role and the wrong or missing option, will
   cause the request to be denied.  If an authorized role is defined with options present, it must be matched.
   The possibility of a authorization request occurring against a authorized role that was not defined with the
   optional options attribute will simply be ignored; i.e. no attempt will be made to evaluate an options attribute
   that does not exist.

   In summary, if every application page and clickable action is predefined in this registry and the
   #has_[access|create|read|update|delete]? api's are used to check access; the application can secure and
   easily administer its core capabilities.

   "Services.Action.Developer" has been implemented to bypass every defined resource.  Please be careful who
   you assign it too.


					    -*-*-*-   Table of Contents  -*-*-*-
	 
	 * Menu Page Registry			    All pages accessable from a menu
	 * GLOBAL System Resources			Unsecured (login, logout, etc.)
	 
	 * GLOBAL User Pages 		        Unsecured (home )
	 * PROTECTED Task Links  			Secured Navigation Links.  (Create Account, Admin, etc.)

	 * Development Resources            Secured pages which show system activity or state


   * FULL RESOURCE SYNTAX **********************************************
    
    <resource secured="true|false">
        <uri>anyString</uri>
        <description></description>
        <permission type="CREATE|READ|UPDATE|DELETE">
            <authorizedRoles>
                <authorizedRole options="anyOption">security-role-name</authorizedRole>
                <authorizedRole>security-user-group-name</authorizedRole>
                <authorizedRole>All Authorized Users</authorizedRole>
            </authorizedRoles>
        </permission>
    </resource>
    
    
    
   * PARTIAL RESOURCE SYNTAX *******************************************
    
    <resource secured="false"> 
        <uri>anyString</uri>
        <description>Any String can be a URI.</description>
    </resource>


-->
    <!--============== RSpec Test Data  ========== -->
    <resource secured="false">
        <uri>testing/public</uri>
        <description>Unsecured or Public Resource.</description>
    </resource>

    <resource secured="true">
        <uri>testing/role/progressive</uri>
        <description>Testing Resource Only: Progressive Capability</description>
        <permission type="READ">
            <authorizedRoles>
                <authorizedRole>Test.Action.Create</authorizedRole>
                <authorizedRole>Test.Action.Read</authorizedRole>
                <authorizedRole>Test.Action.Update</authorizedRole>
                <authorizedRole>Test.Action.Delete</authorizedRole>
            </authorizedRoles>
        </permission>
        <permission type="UPDATE">
            <authorizedRoles>
                <authorizedRole>Test.Action.Update</authorizedRole>
                <authorizedRole>Test.Action.Create</authorizedRole>
                <authorizedRole>Test.Action.Delete</authorizedRole>
            </authorizedRoles>
        </permission>
        <permission type="CREATE">
            <authorizedRoles>
                <authorizedRole>Test.Action.Create</authorizedRole>
                <authorizedRole>Test.Action.Delete</authorizedRole>
            </authorizedRoles>
        </permission>
        <permission type="DELETE">
            <authorizedRoles>
                <authorizedRole>Test.Action.Delete</authorizedRole>
                <authorizedRole>Services.Action.Developer</authorizedRole>
            </authorizedRoles>
        </permission>
    </resource>

    <resource secured="true">
        <uri>testing/role/absolutes</uri>
        <description>Testing Resource Only: Absolute Capability</description>
        <permission type="READ">
            <authorizedRoles>
                <authorizedRole>Test.Action.Read</authorizedRole>
            </authorizedRoles>
        </permission>
        <permission type="UPDATE">
            <authorizedRoles>
                <authorizedRole>Test.Action.Update</authorizedRole>
            </authorizedRoles>
        </permission>
        <permission type="CREATE">
            <authorizedRoles>
                <authorizedRole>Test.Action.Create</authorizedRole>
            </authorizedRoles>
        </permission>
        <permission type="DELETE">
            <authorizedRoles>
                <authorizedRole>Test.Action.Delete</authorizedRole>
                <authorizedRole>Services.Action.Developer</authorizedRole>
            </authorizedRoles>
        </permission>
    </resource>

    <resource secured="true">
        <uri>testing/role/options</uri>
        <description>Testing Resource Only: Options Special Ownership Granting Capability</description>
        <permission type="READ">
            <authorizedRoles>
                <authorizedRole>Test.Action.Read</authorizedRole>
            </authorizedRoles>
        </permission>
        <permission type="UPDATE">
            <authorizedRoles>
                <authorizedRole options="OBJECT-OWNER">Test.Action.Read</authorizedRole>
                <authorizedRole>Test.Action.Update</authorizedRole>
            </authorizedRoles>
        </permission>
        <permission type="CREATE">
            <authorizedRoles>
                <authorizedRole options="CLIENT-MANAGER">Test.Action.Read</authorizedRole>
                <authorizedRole>Test.Action.Create</authorizedRole>
            </authorizedRoles>
        </permission>
        <permission type="DELETE">
            <authorizedRoles>
                <authorizedRole>Test.Action.Delete</authorizedRole>
                <authorizedRole>Services.Action.Developer</authorizedRole>
            </authorizedRoles>
        </permission>
    </resource>

<!--========================= RESOURCE REGISTRY  ================================ -->
    <!--============== System Menu  ========== -->
    <resource secured="true">
        <uri>#Administration</uri>
        <description>Administrative Actions - Menu</description>
        <permission type="READ">
            <authorizedRoles>
                <authorizedRole>Services.Action.Admin</authorizedRole>
                <authorizedRole>Services.Action.Developer</authorizedRole>
            </authorizedRoles>
        </permission>
    </resource>
    <resource secured="true">
        <uri>#GroupManagement</uri>
        <description>Authorization Group Role Actions - Menu</description>
        <permission type="READ">
            <authorizedRoles>
                <authorizedRole>Services.Action.Admin</authorizedRole>
                <authorizedRole>Services.Action.Developer</authorizedRole>
            </authorizedRoles>
        </permission>
    </resource>

    <!--============== PasswordResets Process  ========== -->
    <resource secured="false">
        <uri>password_resets/edit</uri>
        <description>PasswordResets Action - Edit</description>
        <permission type="READ">
            <authorizedRoles>
                <authorizedRole>Services.Action.ResetPassword</authorizedRole>
                <authorizedRole>Services.Action.Developer</authorizedRole>
            </authorizedRoles>
        </permission>
    </resource>
    <resource secured="false">
        <uri>password_resets/update</uri>
        <description>PasswordResets Action - Update</description>
        <permission type="UPDATE">
            <authorizedRoles>
                <authorizedRole>Services.Action.ResetPassword</authorizedRole>
                <authorizedRole>Services.Action.Developer</authorizedRole>
            </authorizedRoles>
        </permission>
    </resource>
   <resource secured="false">
        <uri>password_resets/new</uri>
        <description>PasswordResets Action - New</description>
        <permission type="CREATE">
            <authorizedRoles>
                <authorizedRole>Services.Action.ResetPassword</authorizedRole>
                <authorizedRole>Services.Action.Developer</authorizedRole>
            </authorizedRoles>
        </permission>
    </resource>
    <resource secured="false">
        <uri>password_resets/create</uri>
        <description>PasswordResets Action - Create</description>
        <permission type="CREATE">
            <authorizedRoles>
                <authorizedRole>Services.Action.ResetPassword</authorizedRole>
                <authorizedRole>Services.Action.Developer</authorizedRole>
            </authorizedRoles>
        </permission>
    </resource>

    <!--============== Users Pages  ========== -->
    <resource secured="true">
        <uri>users/index</uri>
        <description>Top Menu Users - Index</description>
        <permission type="READ">
            <authorizedRoles>
                <authorizedRole>Users.Action.Create</authorizedRole>
                <authorizedRole>Users.Action.Read</authorizedRole>
                <authorizedRole>Users.Action.Update</authorizedRole>
                <authorizedRole>Users.Action.Delete</authorizedRole>
                <authorizedRole>Services.Action.Admin</authorizedRole>
                <authorizedRole>Services.Action.Developer</authorizedRole>
                <authorizedRole>EmployeePrimary</authorizedRole>
            </authorizedRoles>
        </permission>
    </resource>
    <resource secured="true">
        <uri>users/show</uri>
        <description>User Action - Show</description>
        <permission type="READ">
            <authorizedRoles>
                <authorizedRole>Users.Action.Create</authorizedRole>
                <authorizedRole>Users.Action.Read</authorizedRole>
                <authorizedRole>Users.Action.Update</authorizedRole>
                <authorizedRole>Users.Action.Delete</authorizedRole>
                <authorizedRole>Services.Action.Developer</authorizedRole>
                <authorizedRole>EmployeePrimary</authorizedRole>
            </authorizedRoles>
        </permission>
    </resource>
    <resource secured="true">
        <uri>users/edit</uri>
        <description>User Action - Edit</description>
        <permission type="UPDATE">
            <authorizedRoles>
                <authorizedRole>Users.Action.Edit</authorizedRole>
                <authorizedRole>Users.Action.Update</authorizedRole>
                <authorizedRole>Services.Action.Developer</authorizedRole>
                <authorizedRole>EmployeePrimary</authorizedRole>
            </authorizedRoles>
        </permission>
    </resource>
    <resource secured="true">
        <uri>users/update</uri>
        <description>User Action - Update</description>
        <permission type="UPDATE">
            <authorizedRoles>
                <authorizedRole>Users.Action.Edit</authorizedRole>
                <authorizedRole>Users.Action.Update</authorizedRole>
                <authorizedRole>Services.Action.Developer</authorizedRole>
                <authorizedRole>EmployeePrimary</authorizedRole>
            </authorizedRoles>
        </permission>
    </resource>
    <resource secured="true">
        <uri>users/new</uri>
        <description>User Action - New</description>
        <permission type="CREATE">
            <authorizedRoles>
                <authorizedRole>Users.Action.Create</authorizedRole>
                <authorizedRole>Users.Action.Delete</authorizedRole>
                <authorizedRole>Services.Action.Developer</authorizedRole>
                <authorizedRole>EmployeePrimary</authorizedRole>
            </authorizedRoles>
        </permission>
    </resource>
    <resource secured="true">
        <uri>users/create</uri>
        <description>User Action - Create</description>
        <permission type="CREATE">
            <authorizedRoles>
                <authorizedRole>Users.Action.Create</authorizedRole>
                <authorizedRole>Users.Action.Delete</authorizedRole>
                <authorizedRole>Services.Action.Developer</authorizedRole>
                <authorizedRole>EmployeePrimary</authorizedRole>
            </authorizedRoles>
        </permission>
    </resource>
    <resource secured="true">
        <uri>users/destroy</uri>
        <description>User Action - Destroy</description>
        <permission type="DELETE">
            <authorizedRoles>
                <authorizedRole>Users.Action.Delete</authorizedRole>
                <authorizedRole>Users.Action.Create</authorizedRole>
                <authorizedRole>Services.Action.Developer</authorizedRole>
                <authorizedRole>EmployeePrimary</authorizedRole>
            </authorizedRoles>
        </permission>
    </resource>


    <!--========================= GLOBAL SYSTEM RESOURCES ============================ -->

    <resource secured="false"> <!-- This resource is not protected, since unauthorized users need to see it. -->
        <uri>/signout</uri>
		    <description>Logout</description>
	  </resource>
    <resource secured="false"> <!-- This resource is not protected, since unauthorized users need to see it. -->
        <uri>/signin</uri>
        <description>Sign-in</description>
    </resource>
    <resource secured="false">
        <uri>pages/home</uri>
        <description>Home</description>
    </resource>
    <resource secured="false">
        <uri>pages/about</uri>
        <description>About</description>
    </resource>

    <!--=========================  DEVELOPMENT RESOURCES  ============================ -->
  <resource secured="true">
      <uri>pages/developer</uri>
      <description>System Status Page for Developers</description>
      <permission type="READ">
          <authorizedRoles>
              <authorizedRole>Services.Action.Developer</authorizedRole>
          </authorizedRoles>
      </permission>
  </resource>

</accessRegistry>
